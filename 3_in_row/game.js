"use strict";var a=(o,e)=>()=>(e||o((e={exports:{}}).exports,e),e.exports);var j=a(h=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0});h.GameMatrix=void 0;var q=class{constructor(e,t){this.matrix=Array.from(Array(t),()=>new Array(e).fill(""))}getRows(){return this.matrix.map(e=>e.join(""))}getCols(){let e=[];for(let t=0;t<this.matrix[0].length;t++){let s=[];for(let i=0;i<this.matrix.length;i++)s.push(this.getValue([i,t]));e[t]=s.join("")}return e}getValue(e){let[t,s]=e;return this.matrix[t][s]}insert(e,t){let[s,i]=e;this.matrix[s][i]=t}iterate(e){this.matrix.forEach((t,s)=>t.forEach((i,r)=>e(i,[s,r])))}remove(e){let[t,s]=e;this.matrix[t][s]=""}get fieldView(){return this.matrix}};h.GameMatrix=q});var _=a(d=>{"use strict";Object.defineProperty(d,"__esModule",{value:!0});d.CoordinatesTuple=void 0;var M=class{constructor(e,t){this.store=[],this.store[0]=e,this.store[1]=t}get first(){return this.store[0]}get second(){return this.store[1]}};d.CoordinatesTuple=M});var C=a(m=>{"use strict";Object.defineProperty(m,"__esModule",{value:!0});m.GameField=void 0;var U=j(),R=_();function l(){let o=["A","B","C","D","E","F"],e=Math.floor(Math.random()*o.length);return o[e]}function V(o,e,t,s){let i=new RegExp(`(.)\\1{${t-1}}`,"g");return Array.from(o.matchAll(i)).flatMap(r=>{let n=r.index,u=n+r[0].length-1;return s?[[n,e],[u,e]]:[[e,n],[e,u]]})}var P=class{constructor(e,t){this.field=new U.GameMatrix(e,t),this.field.iterate((s,i)=>this.addElement(i,l()))}addElement(e,t){this.field.insert(e,t)}removeSequence(e){let t=[...e.first],s=[...e.second];if(t[0]===s[0]){for(;t[1]<s[1];)this.field.remove(t),t[1]+=1;this.field.remove(s)}if(t[1]===s[1]){for(;t[0]<s[0];)this.field.remove(t),t[0]+=1;this.field.remove(s)}}fillSequence(e){let t=[...e.first],s=[...e.second];if(t[0]===s[0]){for(;t[1]<s[1];)this.field.insert(t,l()),t[1]+=1;this.field.insert(s,l())}if(t[1]===s[1]){for(;t[0]<s[0];)this.field.insert(t,l()),t[0]+=1;this.field.insert(s,l())}}removeSequences(e){let[t,s]=e;t.forEach(i=>this.removeSequence(i)),s.forEach(i=>this.removeSequence(i))}fillSequences(e){let[t,s]=e;t.forEach(i=>this.fillSequence(i)),s.forEach(i=>this.fillSequence(i))}searchSequence(e){let t=this.field.getRows().flatMap((r,n)=>V(r,n,e).filter((u,L,S)=>S.length>0)),s=this.field.getCols().flatMap((r,n)=>V(r,n,e,!0).filter((u,L,S)=>S.length>0)),i=[[],[]];for(;t.length;){let[r,n]=t.splice(0,2);i[0].push(new R.CoordinatesTuple(r,n))}for(;s.length;){let[r,n]=s.splice(0,2);i[1].push(new R.CoordinatesTuple(r,n))}return i}switchElements(e){let t=this.field.getValue(e.first),s=this.field.getValue(e.second);this.field.insert(e.first,s),this.field.insert(e.second,t)}get fieldView(){return this.field.fieldView}};m.GameField=P});var A=a(f=>{"use strict";Object.defineProperty(f,"__esModule",{value:!0});f.GameStatistics=void 0;var F=class{constructor(){this.moves=[],this.points=0}addMove(e){this.moves.push(e)}addPoints(e){this.points+=e}get playerPoints(){return this.points}};f.GameStatistics=F});var T=a(g=>{"use strict";Object.defineProperty(g,"__esModule",{value:!0});g.GameOutput=void 0;var O=class{constructor(e,t){this.gameField=e,this.gameStatistics=t}showField(){let e=["A","B","C","D","E"],t=this.gameField.fieldView.map(s=>s.reduce((i,r,n)=>Object.assign(Object.assign({},i),{[e[n]]:r}),{}));console.table(t)}showPoints(){console.log("Player's points ",this.gameStatistics.playerPoints)}invalidMove(){console.log("The move is invalid. Please make a new move")}};g.GameOutput=O});var B=a(p=>{"use strict";Object.defineProperty(p,"__esModule",{value:!0});p.GameRules=void 0;var N=["A","B","C","D","E"],E=class{constructor(e,t){this.width=e,this.height=t}getPointsPerMove(){return 0}isInputValid(e){try{let[t,s]=e.split(",");return!(isNaN(Number(t[1]))||isNaN(Number(s[1])))&&N.includes(t[0])&&N.includes(s[0])}catch{return!1}}isMoveValid(e){let[t,s]=e.first,[i,r]=e.second;return!(t>=this.width||i>=this.width||s>=this.height||r>=this.height)}};p.GameRules=E});var k=a(v=>{"use strict";Object.defineProperty(v,"__esModule",{value:!0});v.UserInput=void 0;var Y=_(),z=require("readline"),H=z.createInterface({input:process.stdin,output:process.stdout}),y=class{constructor(e,t,s){this.setMove=e,this.gameRules=t,this.gameOutput=s}createMove(e){if(!this.gameRules.isInputValid(e)){this.gameOutput.invalidMove(),this.waitForInput();return}let t=this.transformInput(e),[s,i]=t.split(","),r=[Number(s[0]),Number(s[1])],n=[Number(i[0]),Number(i[1])],u=new Y.CoordinatesTuple(r,n);if(!this.gameRules.isMoveValid(u)){this.gameOutput.invalidMove(),this.waitForInput();return}this.setMove(u)}waitForInput(){let e=this.createMove.bind(this);H.question("Your move ",function(t){t.trim()==="exit"?process.exit(0):e(t)})}transformInput(e){let t={A:0,B:1,C:2,D:3,E:4},[s,i]=e.split(","),r=s[1]+t[s[0]],n=i[1]+t[i[0]];return`${r},${n}`}};v.UserInput=y});var D=a(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});c.GameStateIdle=c.GameStateMove=void 0;var J=k(),I=class{constructor(e){this.game=e,this.searchSequences()}searchSequences(){let e=this.game.searchSequence(3);this.game.removeSequences(e),this.game.showField(),this.game.fillSequences(e),this.game.showField(),this.updatePlayerStatistics(e[0].length+e[1].length),this.game.setState("idle")}updatePlayerStatistics(e){this.game.addPoints(e),this.game.showPoints()}};c.GameStateMove=I;var b=class{constructor(e){this.game=e,this.userInput=new J.UserInput(this.makeMove.bind(this),this.game.rules,this.game.output),this.userInput.waitForInput()}makeMove(e){this.game.switchElements(e),this.game.showField(),this.game.addMove(e),this.game.setState("move")}};c.GameStateIdle=b});var $=a(w=>{"use strict";Object.defineProperty(w,"__esModule",{value:!0});w.Game=void 0;var K=C(),Q=A(),W=T(),X=B(),x=D(),G=class{constructor(){this.gameField=new K.GameField(5,5),this.gameStatistics=new Q.GameStatistics,this.gameOutput=new W.GameOutput(this.gameField,this.gameStatistics),this.gameRules=new X.GameRules(5,5),this.gameOutput.showField(),this.gameState=new x.GameStateIdle(this)}setState(e){e==="idle"&&(this.gameState=new x.GameStateIdle(this)),e==="move"&&(this.gameState=new x.GameStateMove(this))}searchSequence(e){return this.gameField.searchSequence(e)}removeSequences(e){this.gameField.removeSequences(e)}fillSequences(e){this.gameField.fillSequences(e)}showField(){this.gameOutput.showField()}addPoints(e){this.gameStatistics.addPoints(e)}showPoints(){this.gameOutput.showPoints()}switchElements(e){this.gameField.switchElements(e)}addMove(e){this.gameStatistics.addMove(e)}get rules(){return this.gameRules}get output(){return this.gameOutput}};w.Game=G});Object.defineProperty(exports,"__esModule",{value:!0});var Z=$();new Z.Game;
